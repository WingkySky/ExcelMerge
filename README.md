# Excel 文件合并工具

这是一个功能强大的 Excel 文件合并工具，提供现代化的图形界面，支持多种合并模式和样式保留。该工具可以帮助您轻松地合并多个 Excel 文件，并提供丰富的自定义选项。

## 功能特点

### 基础功能
- 支持选择多个 Excel 文件（.xlsx, .xls 格式）
- 自定义输出文件保存位置和文件名
- 文件预览功能（支持单文件预览和合并结果预览）
- 定时自动执行合并任务

### 合并选项
- 支持两种合并模式：
  - 合并到单个 Sheet
  - 每个文件保存为独立的 Sheet
- 自定义数据范围（可指定起始行列）
- 灵活的表头设置（可选是否保留表头）
- Sheet 名称自定义（支持自动、原名和自定义三种模式）

### Excel样式保留
- 保留原文件格式设置：
  - 单元格样式（字体、对齐等）
  - 列宽设置
  - 数据格式（数字、日期等）
  - 颜色样式（背景色、字体色）

### 界面设置
- 现代化的用户界面
- 主题定制：
  - 深色/浅色/跟随系统模式切换
  - 多种颜色主题选择（蓝色、深蓝、绿色）
- 实时状态显示
- 友好的错误提示

## 安装要求

- Python 3.7+
- 所需 Python 包：
  - customtkinter >= 5.2.2
  - pandas >= 2.0.0
  - openpyxl >= 3.1.2
  - schedule >= 1.2.0

## 安装步骤

1. 克隆或下载本项目到本地
2. 安装所需依赖：
   ```bash
   pip install -r requirements.txt
   ```

## 使用说明

1. 运行程序：
   ```bash
   python excel_merger.py
   ```

2. 在图形界面中：
   - 【文件选择】标签页：
     - 添加要合并的 Excel 文件
     - 选择输出路径和文件名
     - 可以预览选中的文件或合并结果
   
   - 【合并设置】标签页：
     - 选择合并模式（单Sheet或多Sheet）
     - 设置数据范围（起始行列）
     - 配置表头选项
   
   - 【Excel样式】标签页：
     - 选择需要保留的Excel文件样式
     - 设置格式保留选项
   
   - 【界面设置】标签页：
     - 选择软件界面主题（深色/浅色）
     - 设置界面颜色主题
   
   - 【定时任务】标签页：
     - 设置自动执行时间（24小时制，如：08:00）

3. 执行合并：
   - 点击"立即执行合并"进行合并
   - 或设置定时任务自动执行

## 注意事项

- 合并到单个Sheet时，建议确保所有文件的表头结构一致
- 定时任务在程序运行期间有效，关闭程序后需要重新设置
- 合并后的文件会自动添加时间戳，避免覆盖之前的文件
- 预览功能最多显示1000行数据
- Sheet名称不能超过31个字符且不能包含特殊字符

## 错误处理

程序会通过友好的界面提示处理以下常见问题：

- 文件格式不正确
- 文件被其他程序占用
- 表头结构不一致
- Sheet名称冲突
- 输出路径无效
